<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>custom middlewares | docs</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-advanced-emoji/emoji-website.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="../../front-end/redux/directory-structure.html" />
    
    
    <link rel="prev" href="../../front-end/redux/dependencies.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="2.2.2"
        data-chapter-title="custom middlewares"
        data-filepath="front-end/redux/custom-middlewares.md"
        data-basepath="../.."
        data-revision="Mon Nov 21 2016 18:52:04 GMT-0800 (PST)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="GitHub/index.html">
            
                
                    <a href="../../GitHub/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        git and GitHub usage
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="front-end/index.html">
            
                
                    <a href="../../front-end/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        front-end @ Tidepool
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="front-end/react/index.html">
            
                
                    <a href="../../front-end/react/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        React @ Tidepool
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="front-end/react/recommended-reading.html">
            
                
                    <a href="../../front-end/react/recommended-reading.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.1.</b>
                        
                        recommended reading
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="front-end/react/dependencies.html">
            
                
                    <a href="../../front-end/react/dependencies.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.2.</b>
                        
                        dependencies
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="front-end/react/testing.html">
            
                
                    <a href="../../front-end/react/testing.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.3.</b>
                        
                        testing strategies
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="front-end/redux/index.html">
            
                
                    <a href="../../front-end/redux/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Redux @ Tidepool
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="front-end/redux/dependencies.html">
            
                
                    <a href="../../front-end/redux/dependencies.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.1.</b>
                        
                        dependencies
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="2.2.2" data-path="front-end/redux/custom-middlewares.html">
            
                
                    <a href="../../front-end/redux/custom-middlewares.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.2.</b>
                        
                        custom middlewares
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2.3" data-path="front-end/redux/directory-structure.html">
            
                
                    <a href="../../front-end/redux/directory-structure.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.3.</b>
                        
                        directory structure
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2.4" data-path="front-end/redux/actions.html">
            
                
                    <a href="../../front-end/redux/actions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.4.</b>
                        
                        standard actions
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2.5" data-path="front-end/redux/testing.html">
            
                
                    <a href="../../front-end/redux/testing.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.5.</b>
                        
                        testing strategies
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="front-end/recipes.html">
            
                
                    <a href="../../front-end/recipes.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        recipes &amp; workflows
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../" >docs</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h3 id="custom-middlewares">Custom Middlewares</h3>
<p>One of the great benefits of redux is the easy path it provides for writing middleware to perform various actions in response to some or all of the redux actions that are the source of all changes to the application&apos;s state tree. The open-source community provides some great middleware options like the <a href="https://github.com/fcomb/redux-logger" title="GitHub: redux-logger" target="_blank">redux-logger</a> that we include behind an environment variable to assist in development.</p>
<p>If you&apos;re unfamiliar with the concept of middleware, the <a href="http://redux.js.org/docs/advanced/Middleware.html" title="Redux " target="_blank">section of the redux documentation dedicated to middleware</a> is a well-written, easily-understood thing of beauty. Go read it.</p>
<p>For our use cases at Tidepool, we are currently employing two custom middlewares. Thus far, these are only fully in use in the Chrome uploader and used for just a few metrics and API errors in blip.</p>
<h4 id="metrics-middleware">Metrics Middleware</h4>
<p>The metrics middleware inspects each action that flows through it to see if the action has a <code>metric</code> object inside the <code>meta</code> property of the action. (See <a href="#standardized-actions">Standardized Actions</a> below for an explanation of the <code>meta</code> property.) If the action does have an object at <code>meta.metric</code>, then the middleware calls the Tidepool metrics endpoint with data extracted from <code>metric.eventName</code> and <code>metric.properties</code>.</p>
<p>In the Chrome uploader, the intersection between &quot;things we want metrics for&quot; and &quot;events that are already part of the redux implementation&quot; is nearly perfect; the only exception is the need for an action creator connected to the link to launch blip in a browser window, which does not affect the uploader&apos;s state at all and so would not normally need an action creator for the reducers to respond to and effect change in the store.</p>
<p>In blip, the intersection between &quot;things we want metrics for&quot; and &quot;events that are already part of the redux implementation&quot; is much smaller, which is why we&apos;re only using a metrics middleware for <a href="https://github.com/tidepool-org/blip/blob/master/app/redux/utils/trackingMiddleware.js" title="GitHub: blip app/redux/utils/trackingMiddleware.js" target="_blank">a few metrics</a>.</p>
<h4 id="error-logging-middleware">Error Logging Middleware</h4>
<p>The error logging middleware inspects each action that flows through it to see if the action has its <code>error</code> property set to <code>true</code>. If so, then the middleware calls the Tidepool metrics endpoint with data extracted from the action <code>payload</code> (which will be an <code>Error</code> object according to our <a href="#standardized-actions">Standardized Actions</a>) as well as data extracted from <code>metric</code> inside the <code>meta</code> property as above.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../../front-end/redux/dependencies.html" class="navigation navigation-prev " aria-label="Previous page: dependencies"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../../front-end/redux/directory-structure.html" class="navigation navigation-next " aria-label="Next page: directory structure"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../../gitbook/app.js"></script>

    
    <script src="../../gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"advanced-emoji":{"embedEmojis":false},"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
